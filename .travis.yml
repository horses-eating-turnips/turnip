language: php
php:
  - 5.3
  - 5.4

install:
  - git reset --hard
  - git clean -dxf
  - sudo apt-get update > /dev/null
  - sudo apt-get install php5-curl > /dev/null
  - sudo apt-get install php-pear
  - sudo pear channel-discover pear.drush.org && sudo pear install drush/drush
  - sudo drush
  - sudo chown -R $USER:$USER /home/$USER/.drush
  - touch shared/settings.local.php
before_script:
  - mysql -e 'create database turnip'
  # Init the settings file
  # @todo make this a proper drush command instead of hacking.
  - echo -e "<?php\n\$databases = array(\n  'default' => array(\n    'default' => array(\n      'database' => 'turnip',\n      'username' => 'travis',\n      'password' => '',\n      'host' => 'localhost',\n      'port' => '',\n      'driver' => 'mysql',\n      'prefix' => '',\n    ),\n  ),\n);\n" > shared/settings.local.php
  - bin/make-install-profile client_xyz xyz_foobar "Web app ABC" "Client XYZ's ABC app enables users to browse a database of records."

script: bin/install
